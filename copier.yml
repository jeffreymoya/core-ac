project_name:
  type: str
  help: 1. Project Name (Pulse8 <Archetype> <Name>)
  default: 'Pulse8 YourName Backend'

project_id:
  type: str
  help: 2. Project Id (pulse8-<archetype>-<name>) - folder name, used in different settings (docker or k8s image names, ...)
  default: "{{ project_name|lower|replace(' ', '-') }}"
  validator: >-
    {% if not (project_id | regex_search('^[a-z0-9\-\_]+$')) %}
    Project Id must contain only lowercase letters, digits, dashes or underscores. Cannot be empty.
    {% endif %}

project_description:
  type: str
  help: 3. Short project Description (leave empty to skip)

group_id:
  type: str
  help: 4. Maven groupId
  default: 'com.synpulse8.pulse8.core'
  validator: >-
    {% if not (group_id | regex_search('^[a-z0-9\.]+$')) %}
    Maven groupId must contain only lowercase letters, digits or dots. Cannot be empty.
    {% endif %}

artifact_id_raw:
  type: str
  help: 5. Maven artifactId
  default: 'yourname-backend'
  validator: >-
    {% if not (artifact_id_raw | regex_search('^[a-z0-9\-\.]+$')) %}
    Maven artifactId must contain only lowercase letters, digits, dots or dashes. Cannot be empty.
    {% endif %}

add_env_qa:
  type: bool
  help: 6. Add QA (Quality Assurance) environment ? [n]
  default: false

add_env_prod:
  type: bool
  help: 7. Add PROD (Production) environment ? [n]
  default: false

add_database:
  type: bool
  help: 8. Add database for selected environments ? [n]
  default: false

# DEV database connection
database_dev_system:
  type: str
  help: 8.1. Select database option (dev)
  when: "{{ add_database }}"
  choices:
    PostgreSQL: 'postgres'
  default: 'postgres'

database_dev_url:
  type: str
  help: 8.2. Database jdbc url (dev)
  when: "{{ add_database }}"
  default: 'jdbc:postgresql://localhost:5432/postgres'

database_dev_username:
  type: str
  help: 8.3. Database username (dev)
  when: "{{ add_database }}"
  default: 'postgres'

database_dev_password:
  type: str
  secret: true
  help: 8.4. Database password (dev) [postgres]
  when: "{{ add_database }}"
  default: 'postgres'

database_dev_schema:
  type: str
  help: 8.5. Database default schema (dev)
  when: "{{ add_database }}"
  default: 'public'

# QA database connection
database_qa_system:
  type: str
  help: 8.1. Select database option (qa)
  when: "{{ add_database and add_env_qa }}"
  choices:
    PostgreSQL: 'postgres'
  default: 'postgres'

database_qa_url:
  type: str
  help: 8.2. Database jdbc url (qa)
  when: "{{ add_database and add_env_qa }}"
  default: "{{ database_dev_url }}"

database_qa_username:
  type: str
  help: 8.3. Database username (qa)
  when: "{{ add_database and add_env_qa }}"
  default: "{{ database_dev_username }}"

database_qa_password:
  type: str
  secret: true
  help: 8.4. Database password (qa) [<password typed for dev environment>]
  when: "{{ add_database and add_env_qa }}"
  default: "{{ database_dev_password }}"

database_qa_schema:
  type: str
  help: 8.5. Database default schema (qa)
  when: "{{ add_database and add_env_qa }}"
  default: "{{ database_dev_schema }}"

# PROD database connection
database_prod_system:
  type: str
  help: 8.1. Select database option (prod)
  when: "{{ add_database and add_env_prod }}"
  choices:
    PostgreSQL: 'postgres'
  default: 'postgres'

database_prod_url:
  type: str
  help: 8.2. Database jdbc url (prod)
  when: "{{ add_database and add_env_prod }}"
  default: "{{ database_dev_url }}"

database_prod_username:
  type: str
  help: 8.3. Database username (prod)
  when: "{{ add_database and add_env_prod }}"
  default: "{{ database_dev_username }}"

database_prod_password:
  type: str
  secret: true
  help: 8.4. Database password (prod) [<password typed for dev environment>]
  when: "{{ add_database and add_env_prod }}"
  default: "{{ database_dev_password }}"

database_prod_schema:
  type: str
  help: 8.5. Database default schema (prod)
  when: "{{ add_database and add_env_prod }}"
  default: "{{ database_dev_schema }}"

add_liquibase:
  type: bool
  help: 9. Add liquibase ? [n]
  when: "{{ add_database }}"
  default: false

add_kafka:
  type: bool
  help: 10. Add kafka for selected environments ? [n]
  default: false

# DEV kafka settings
kafka_dev_bootstrap_servers:
  type: str
  help: 10.1. Kafka bootstrap-servers (dev)
  when: "{{ add_kafka }}"
  default: 'localhost:9092'

kafka_dev_group_id:
  type: str
  help: 10.2. Kafka group-id (dev)
  when: "{{ add_kafka }}"
  default: 'main'

kafka_dev_default_topic:
  type: str
  help: 10.3. Kafka default-topic (dev)
  when: "{{ add_kafka }}"
  default: 'general'

# QA kafka settings
kafka_qa_bootstrap_servers:
  type: str
  help: 10.1. Kafka bootstrap-servers (qa)
  when: "{{ add_kafka and add_env_qa }}"
  default: "{{ kafka_dev_bootstrap_servers }}"

kafka_qa_group_id:
  type: str
  help: 10.2. Kafka group-id (qa)
  when: "{{ add_kafka and add_env_qa }}"
  default: "{{ kafka_dev_group_id }}"

kafka_qa_default_topic:
  type: str
  help: 10.3. Kafka default-topic (qa)
  when: "{{ add_kafka and add_env_qa }}"
  default: "{{ kafka_dev_default_topic }}"

# PROD kafka settings
kafka_prod_bootstrap_servers:
  type: str
  help: 10.1. Kafka bootstrap-servers (prod)
  when: "{{ add_kafka and add_env_prod }}"
  default: "{{ kafka_dev_bootstrap_servers }}"

kafka_prod_group_id:
  type: str
  help: 10.2. Kafka group-id (prod)
  when: "{{ add_kafka and add_env_prod }}"
  default: "{{ kafka_dev_group_id }}"

kafka_prod_default_topic:
  type: str
  help: 10.3. Kafka default-topic (prod)
  when: "{{ add_kafka and add_env_prod }}"
  default: "{{ kafka_dev_default_topic }}"

kafka_add_example:
  type: bool
  help: 10.4. Add kafka directory structure with example ? [n]
  when: "{{ add_kafka }}"
  default: false

add_kafka_schema_registry:
  type: bool
  help: 10.5. Add schema registry ?
  when: "{{ add_kafka }}"
  default: false

kafka_schema_registry_url:
  type: str
  help: 10.6. schema registry url?
  when: "{{ add_kafka_schema_registry }}"
  default: 'http://schemaregistry:8084'

add_keycloak:
  type: bool
  help: 11. Add keycloak for selected environments ? [n]
  default: false

# DEV keycloak settings
keycloak_dev_client_id:
  type: str
  help: 11.1. Keycloak client-id (dev)
  when: "{{ add_keycloak }}"
  default: 'p8c-test'

keycloak_dev_client_secret:
  type: str
  help: 11.2. Keycloak client-secret (dev) (leave empty to skip)
  when: "{{ add_keycloak }}"

keycloak_dev_issuer_uri:
  type: str
  help: 11.3. Keycloak issuer-uri (dev)
  when: "{{ add_keycloak }}"
  default: 'https://keycloak.pulse8.synpulse8.com/realms/master'

keycloak_dev_redirect_uri:
  type: str
  help: 11.4. Keycloak redirect-uri (dev) (leave empty to skip)
  when: "{{ add_keycloak }}"

# QA keycloak settings
keycloak_qa_client_id:
  type: str
  help: 11.1. Keycloak client-id (qa)
  when: "{{ add_keycloak and add_env_qa }}"
  default: "{{ keycloak_dev_client_id }}"

keycloak_qa_client_secret:
  type: str
  help: 11.2. Keycloak client-secret (qa) (leave empty to skip)
  when: "{{ add_keycloak and add_env_qa }}"
  default: "{{ keycloak_dev_client_secret }}"

keycloak_qa_issuer_uri:
  type: str
  help: 11.3. Keycloak issuer-uri (qa)
  when: "{{ add_keycloak and add_env_qa }}"
  default: "{{ keycloak_dev_issuer_uri }}"

keycloak_qa_redirect_uri:
  type: str
  help: 11.4. Keycloak redirect-uri (qa) (leave empty to skip)
  when: "{{ add_keycloak and add_env_qa }}"
  default: "{{ keycloak_dev_redirect_uri }}"

# PROD keycloak settings
keycloak_prod_client_id:
  type: str
  help: 11.1. Keycloak client-id (prod)
  when: "{{ add_keycloak and add_env_prod }}"
  default: "{{ keycloak_dev_client_id }}"

keycloak_prod_client_secret:
  type: str
  help: 11.2. Keycloak client-secret (prod) (leave empty to skip)
  when: "{{ add_keycloak and add_env_prod }}"
  default: "{{ keycloak_dev_client_secret }}"

keycloak_prod_issuer_uri:
  type: str
  help: 11.3. Keycloak issuer-uri (prod)
  when: "{{ add_keycloak and add_env_prod }}"
  default: "{{ keycloak_dev_issuer_uri }}"

keycloak_prod_redirect_uri:
  type: str
  help: 11.4. Keycloak redirect-uri (prod) (leave empty to skip)
  when: "{{ add_keycloak and add_env_prod }}"
  default: "{{ keycloak_dev_redirect_uri }}"

add_core_iam_feign:
  type: bool
  help: 12. Add Pulse8 Core IAM feign client integration ? [n]
  default: false

add_k8s:
  type: bool
  help: 13. Add kubernetes deployment ? [n]
  default: false

k8s_port:
  type: int
  help: 13.1. Kubernetes deployment port
  when: "{{ add_k8s }}"
  default: 3010

k8s_port_debug:
  type: int
  help: 13.2. Kubernetes deployment debug port
  when: "{{ add_k8s }}"
  default: 5010

k8s_replicas_count:
  type: int
  help: 13.3. Count of replicas in kubernetes deployment (for failover 3+ replicas is recommended)
  when: "{{ add_k8s }}"
  default: 3

k8s_database_url:
  type: str
  help: 13.4. Database URL for kubernetes container
  when: "{{ add_k8s and add_database }}"
  default: 'jdbc:postgresql://pulse8-central-postgres:5432/postgres'

add_docker:
  type: bool
  help: 14. Add local docker image generation config and scripts (docker compose, helper scripts) ? [n]
  default: false

docker_database_url:
  type: str
  help: 14.1. Database URL for docker image
  when: "{{ add_docker and add_database }}"
  default: 'jdbc:postgresql://pulse8-central-postgres:5432/postgres'

docker_image_port_run:
  type: int
  help: 14.2. Docker Image run port
  when: "{{ add_docker }}"
  default: 3010

docker_image_port_debug:
  type: int
  help: 14.3. Docker Image debug port
  when: "{{ add_docker }}"
  default: 5010

docker_image_network_name:
  type: str
  help: 14.4. Docker Image network name
  when: "{{ add_docker }}"
  default: 'pulse8-central-bridge'

docker_image_container_group:
  type: str
  help: 14.5. Docker Image container group
  when: "{{ add_docker }}"
  default: 'services'

add_spock:
  type: bool
  help: 15. Add spock testing framework ? [n]
  default: false

add_aquasec:
  type: bool
  help: 16. Add aquasec Dockerfile scan ? [n]
  default: false

github_actions_workflow_name:
  type: str
  help: 17. Github actions workflow name
  default: 'PULSE8-CORE YOUR NAME BACKEND CI'

add_sonar:
  type: bool
  help: 18. Add SonarCloud scan github action ? [n]
  default: false

sonar_project_key_suffix:
  type: str
  help: 18.1. Sonar project key suffix (synpulse-group_<suffix>)
  when: "{{ add_sonar }}"
  default: "{{ project_id }}"
  validator: >-
    {% if not (sonar_project_key_suffix | regex_search('^[a-z0-9\-\_]*$')) %}
    Sonar project key suffix must contain only lowercase letters, digits, dashes or underscores.
    {% endif %}

add_example:
  type: bool
  help: 19. Add code examples ? (Controller, Service, Repository, liquibase changelog, ...) [n]
  default: false

_answers_file: .copier-answers.yml

_exclude:
  - '/.git'
  - '/.idea'
  - '/target'
  - '/copier.yml'
  - '/extensions'
  - '/builds'
  - '/.github/workflows/template-build*'
  - '/requirements.txt'
  - '/copier-build.sh'

_jinja_extensions:
  - 'copier_templates_extensions.TemplateExtensionLoader'
  - 'extensions/context.py:ContextUpdater'
